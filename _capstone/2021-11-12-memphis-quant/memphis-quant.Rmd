---
title: "Memphis Housing Market"
description: |
  Reviewing the Memphis housing market.
author:
  - name: Sarah Johnson
date: 2021-11-18
output:
  distill::distill_article:
    self_contained: false
    toc: true
draft: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

```{r library, include=FALSE}
library(tidyverse)
library(tidycensus)
library(DT)
```

```{r variables}
vbs <- load_variables(2019, "acs5")
```

```{r cbsa, include=FALSE}
cbsa <- get_acs(
  geography = "cbsa",
  variables = c(
    Owner = "B25003_002",
    Renter = "B25003_003"
  ),
  summary_var = "B25003_001",
  cache_table = TRUE
) %>%
  slice_max(summary_est, n = 100) %>% 
  mutate(percent = 100 * (estimate / summary_est))
```

Below is a table of the top 50 metros by number of occupied housing units, sorted by the percentage of renters.

```{r cbsaRent}
cbsaRent <- cbsa %>% 
  filter(variable == "Renter") %>% 
  select(NAME, estimate, summary_est, percent) %>% 
  arrange(desc(percent)) %>% 
  mutate(NAME = str_remove(NAME, "-.*$")) %>% 
  mutate(NAME = str_remove(NAME, ",.*$")) 
```

```{r cbsaDT}
datatable(
  cbsaRent,
  rownames = FALSE,
  colnames = c('Metro Area', 'Renters', 'Total Households', 'Rent Percentage'),
  caption = "Table 1: Percent of Renters in US Metro Areas"
) %>%
  formatPercentage(4, mark = ".", interval = 2) %>%
  formatRound(2:3, digits = 0)
```

The Memphis MSA ranks 10th, with 40% of all occupied housing units being renter-occupied.

# Location

```{r county, include=FALSE}
county <- get_acs(
  geography = "county",
  state = "TN",
  county = "Shelby",
  variables = c(
    Owner = "B25003_002",
    Renter = "B25003_003"
  ),
  summary_var = "B25003_001",
  cache_table = TRUE,
  geometry = TRUE
) %>% 
  mutate(percent = 100 * (estimate / summary_est))
```

```{r placesV}
places <- c("Memphis", "Lakeland", "Bartlett", "Germantown", "Collierville", "Millington", "Arlington") %>% 
  str_c(collapse = "|")
```

```{r place, include=FALSE}
place <- get_acs(
  geography = "place",
  state = "TN",
  variables = c(
    Owner = "B25003_002",
    Renter = "B25003_003"
  ),
  summary_var = "B25003_001",
  cache_table = TRUE
) %>% 
  filter(str_detect(NAME, places)) %>% 
  mutate(percent = 100 * (estimate / summary_est))
```

The following table shows the percentage of renters for each place in Shelby County.

```{r placeTable}
placeTable <- place %>% 
  filter(variable == "Renter") %>% 
  select(NAME, estimate, summary_est, percent) %>% 
  arrange(desc(percent)) %>%  
  mutate(NAME = str_remove(NAME, ",.*$"),
         NAME = str_remove(NAME, " town| city")) 
```

```{r placeDT}
datatable(
  placeTable,
  rownames = FALSE,
  colnames = c('Place', 'Renters', 'Total Households', 'Rent Percentage'),
  caption = "Table 2: Percent of Renters in Places in Shelby County",
  options = list(pageLength = 7),
  autoHideNavigation = getOption("DT.autoHideNavigation", TRUE)
) %>% formatPercentage(4, mark = ".", interval = 2) %>% 
  formatRound(2:3, digits = 0)
```

While the overall MSA is majority owner-occupied housing, the city of Memphis is majority renter-occupied. The next highest percentage is Millington, which is home to an Air Force base, where people may be only temporarily stationed.

```{r tract, include=FALSE}
tract <- get_acs(
  geography = "tract",
  state = "TN",
  county = "Shelby",
  variables = c(
    Owner = "B25003_002",
    Renter = "B25003_003"
  ),
  summary_var = "B25003_001",
  cache_table = TRUE,
  geometry = TRUE
) %>% 
  mutate(percent = 100 * (estimate / summary_est))
```

```{r map, layout = 'l-page'}
library(mapview)
mapview(tract, zcol = "percent")
```

# Renter Demographics

## Race of Householder

```{r raceVs}
raceVs <- c(
  White = "B25003H_003",
  Black = "B25003B_003",
  Hispanic = "B25003I_003",
  Asian = "B25003D_003"
)
```

The below table shows the number of renting households in Memphis, by race.

```{r racePlace, include=FALSE}
racePlace <- get_acs(
  geography = "place",
  state = "TN",
  variables = raceVs,
  summary_var = "B25003_003",
  cache_table = TRUE
) %>% 
  filter(str_detect(NAME, places)) %>% 
  mutate(percent = 100 * (estimate / summary_est))
```

```{r raceTable}
raceTable <- racePlace %>% 
  filter(str_detect(NAME, "Memphis")) %>% 
  select(variable, estimate, summary_est, percent) %>% 
  arrange(desc(percent))
```

```{r raceDT}
datatable(
  raceTable,
  rownames = FALSE,
  colnames = c('Race/Ethnicity', 'Renters', 'Total Renters', 'Percentage'),
  caption = "Table 3: Race/Ethnicity of Renters in Memphis",
  options = list(pageLength = 4),
  autoHideNavigation = getOption("DT.autoHideNavigation", TRUE)
) %>% formatPercentage(4, mark = ".", interval = 2) %>% 
  formatRound(2:3, digits = 0)
```

Where do the renters live? (by race)

```{r raceTract, include=FALSE}
raceTract <- get_acs(
  geography = "tract",
  state = "TN",
  county = "Shelby",
  variables = raceVs,
  summary_var = "B25003_003",
  cache_table = TRUE,
  geometry = TRUE
) %>% 
  mutate(percent = 100 * (estimate / summary_est))
```

```{r mapRace, layout = 'l-page'}
ggplot(raceTract, aes(fill = percent)) +
  geom_sf() +
  facet_wrap(~variable) +
  theme_void() +
  labs(title = "Race/Ethnicity of Renters in Shelby County Census Tracts")
```

## Age of Householder

How old are the renters?

```{r ageVs}
ageVs <- c(
  "15-24" = "B25007_013",
  "25-34" = "B25007_014",
  "35-44" = "B25007_015",
  "45-54" = "B25007_016",
  "55-59" = "B25007_017",
  "60-64" = "B25007_018",
  "65-74" = "B25007_019",
  "75-84" = "B25007_020",
  "85+" = "B25007_021"
)
```

```{r agePlace, include=FALSE}
agePlace <- get_acs(
  geography = "place",
  state = "TN",
  variables = ageVs,
  summary_var = "B25007_012",
  cache_table = TRUE
) %>% 
  filter(str_detect(NAME, places)) %>% 
  mutate(percent = 100 * (estimate / summary_est))
```

The below graph shows the number of renters in Memphis, by age.

```{r memphisAge}
ageMemphis <- agePlace %>% 
  filter(str_detect(NAME, "Memphis")) %>% 
  select(variable, estimate, summary_est, percent)
```

```{r ggAge}
ggplot(ageMemphis, aes(x = variable, y = estimate)) +
  geom_col(fill = "lightseagreen") +
  theme_minimal() +
  labs(title = "Age of renters in Memphis, TN",
       subtitle = "2015-2019 5-year ACS estimates",
       y = "Estimate",
       x = "Age")
```

Of renting households in Memphis, the highest percentage are in the 25-34 age range, followed by the 35-44 age range, then the 45-54 age range. While renters skew younger, there are still a sizeable number of older renters; 12.6% of all renting households in Memphis are over 65, the typical retirement age. Note that this figure does not include people in nursing homes (these individuals are included in the "group quarters population").

## Household Size

What is the household size of renters?

```{r HHsizeVs}
HHsizeVs <- c(
  "1" = "B25009_011",
  "2" = "B25009_012",
  "3" = "B25009_013",
  "4" = "B25009_014",
  "5" = "B25009_015",
  "6" = "B25009_016",
  "7+" = "B25009_017"
)
```

```{r HHsizePlace, include=FALSE}
HHsizePlace <- get_acs(
  geography = "place",
  state = "TN",
  variables = HHsizeVs,
  summary_var = "B25009_010",
  cache_table = TRUE
) %>% 
  filter(str_detect(NAME, places)) %>% 
  mutate(percent = 100 * (estimate / summary_est))
```

```{r memphisHHsizeTable}
HHsizeMemphis <- HHsizePlace %>% 
  filter(str_detect(NAME, "Memphis")) %>% 
  select(variable, estimate, summary_est, percent)
```

```{r ggHHsize}
ggplot(HHsizeMemphis, aes(x = variable, y = estimate)) + 
  geom_col(fill = "steelblue") +
  theme_minimal() +
  labs(title = "Household size of renters in Memphis, TN",
       subtitle = "2015-2019 5-year ACS estimates",
       y = "Estimate",
       x = "People in Household")
```

Of renting households in Memphis, 42% live alone.

## Cost Burden

Rent Burdened?

```{r GRAPHIvs}
GRAPHIvs <- c(
  "Less than 10.0%" = "B25070_002",
  "10.0-14.9%" = "B25070_003",
  "15.0-19.9%" = "B25070_004",
  "20.0-24.9%" = "B25070_005",
  "25.0-29.9%" = "B25070_006",
  "30.0-34.9%" = "B25070_007",
  "35.0-39.9%" = "B25070_008",
  "40.0-49.9%" = "B25070_009",
  "50.0% or more" = "B25070_010",
  "Not computed" = "B25070_011"
)
```

```{r GRAPHI, include=FALSE}
GRAPHIplace <- get_acs(
  geography = "place",
  state = "TN",
  variables = GRAPHIvs,
  summary_var = "B25070_001",
  cache_table = TRUE
) %>% 
  filter(str_detect(NAME, places)) %>% 
  mutate(percent = 100 * (estimate / summary_est))
```

```{r memGRAPHItbl}
GRAPHImemphis <- GRAPHIplace %>% 
  filter(str_detect(NAME, "Memphis")) %>% 
  select(variable, estimate, summary_est, percent)
```

```{r ggGRAPHI}
ggplot(GRAPHImemphis, aes(x = estimate, y = fct_reorder(variable, GRAPHIvs, .desc = TRUE))) +
  geom_col(fill = "mediumseagreen") +
  theme_minimal() +
  labs(title = "Cost burden of renters in Memphis, TN",
       subtitle = "2015-2019 5-year ACS estimates",
       y = "Cost Burden",
       x = "Estimate")
```

Of renting households in Memphis, the majority, 51.2% are cost burdened or extremely cost burdened. 23.5% pay between 30-50% of their income in rent. 27.7% pay 50% or more of their income in rent.

The below table shows cost burden rates for every place in Shelby County.

```{r GRAPHI2, include=FALSE}
GRAPHIplace2 <- get_acs(
  geography = "place",
  state = "TN",
  variables = c(
    "B25070_002",
    "B25070_003",
    "B25070_004",
    "B25070_005",
    "B25070_006",
    "B25070_007",
    "B25070_008",
    "B25070_009",
    "B25070_010",
    "B25070_011"
  ), 
  summary_var = "B25070_001",
  cache_table = TRUE
) %>% 
  filter(str_detect(NAME, places)) %>% 
  mutate(percent = 100 * (estimate / summary_est))
```

```{r groupedGRAPHI, layout = 'l-page'}
GRAPHIgrouped <- GRAPHIplace2 %>% 
  mutate(costBurden = case_when(
    variable < "B25070_007" ~ "notCostBurdened",
    variable < "B25070_010" ~ "costBurdened",
    variable < "B25070_011" ~ "extremelyCostBurdened",
    TRUE ~ "notComputed"
  )) %>% 
  group_by(NAME, costBurden, summary_est) %>% 
  summarise(estimate = sum(estimate)) %>% 
  mutate(percent = 100 * (estimate / summary_est)) %>% 
  select(-c(summary_est, estimate)) %>% 
  pivot_wider(names_from = costBurden, values_from = percent) %>% 
  select(NAME, notCostBurdened, costBurdened, extremelyCostBurdened, notComputed) %>% 
  arrange(desc(notCostBurdened)) %>%  
  mutate(NAME = str_remove(NAME, ",.*$"),
         NAME = str_remove(NAME, " town| city"))
```

```{r}
datatable(
  GRAPHIgrouped,
  rownames = FALSE,
  colnames = c('Place', 'Not Cost Burdened', 'Cost Burdened', 'Extremely Cost Burdened', 'Not Computed'),
  caption = "Table 4: Cost Burden of Renters in Places in Shelby County",
  options = list(pageLength = 7),
  autoHideNavigation = getOption("DT.autoHideNavigation", TRUE)
) %>% formatPercentage(2:5, mark = ".", interval = 2)
```

Collierville has the lowest rate of cost burdenship, with 61% of renting households having affordable housing. Memphis has the highest rate of cost burdenship, with the majority of households paying more than 30% of their income in rent.

# Housing Characteristics

## Year Structure Built

What is the age of housing?

```{r yearBltVs}
yearBltVs <- c(
  "Built 2014 or later" = "B25036_014",
  "Built 2010 to 2013" = "B25036_015",
  "Built 2000 to 2009" = "B25036_016",
  "Built 1990 to 1999" = "B25036_017",
  "Built 1980 to 1989" = "B25036_018",
  "Built 1970 to 1979" = "B25036_019",
  "Built 1960 to 1969" = "B25036_020",
  "Built 1950 to 1959" = "B25036_021",
  "Built 1940 to 1949" = "B25036_022",
  "Built 1939 or earlier" = "B25036_023"
)
```

```{r yearBltPlace, include=FALSE}
yearBltPlace <- get_acs(
  geography = "place",
  state = "TN",
  variables = yearBltVs,
  summary_var = "B25036_013",
  cache_table = TRUE
) %>% 
  filter(str_detect(NAME, places)) %>% 
  mutate(percent = 100 * (estimate / summary_est))
```

The table below shows the year the home was built for renter-occupied households.

```{r memphisYrBlt}
yearBltMemphis <- yearBltPlace %>% 
  filter(str_detect(NAME, "Memphis")) %>% 
  select(variable, estimate, summary_est, percent)
```

```{r ggYrBlt}
ggplot(yearBltMemphis, aes(x = estimate, y = variable)) +
  geom_col(fill = "peru") +
  theme_minimal() +
  labs(title = "Year built of renter-occupied housing in Memphis, TN",
       subtitle = "2015-2019 5-year ACS estimates",
       y = "Year Built",
       x = "Estimate")
```

Of renter-occupied housing in Memphis, the greatest percentage was built between 1970 and 1979. Very little of this housing was built within the past decade.

Older structures are more likely to need maintenance, and they can be susceptible to health risks that are not in newer homes. For instance, the ban on lead based paint was not passed until 1979, and homes built before the ban are likely to have lead paint unless they have been remediated. In Memphis, 63% of renter-occupied housing was built before 1979.

## Housing Quality Problems

What kind of problems does the housing have?

```{r AHSimport, include=FALSE}
AHSimport <- read_csv("AHS-mem-hsgqual-all.csv")
```

```{r AHSall}
AHSall <- AHSimport %>% 
  filter(tenure == "Renter") %>% 
  select(char:estimate, total) %>% 
  mutate(percent = 100 * (estimate/total))
```

According to the American Housing Survey, 93.53% of renters had adequate housing, while 6.47% had moderate or severely inadequate housing.

The table below shows the most common problems renters experience, according to the American Housing Survey.

+-------------------------------------------------------------------------------------------------------+----------+------------+
| Characteristic                                                                                        | Estimate | Percentage |
+=======================================================================================================+==========+============+
| Signs of cockroaches in last 12 months                                                                | 50,900   | 22.72%     |
+-------------------------------------------------------------------------------------------------------+----------+------------+
| Bars on windows\*                                                                                     | 16,100\* | 13.69%\*   |
+-------------------------------------------------------------------------------------------------------+----------+------------+
| Signs of mice or rats inside home in last 12 months                                                   | 24,400   | 10.89%     |
+-------------------------------------------------------------------------------------------------------+----------+------------+
| Water leakage from inside structure in last 12 months                                                 | 19,500   | 8.71%      |
+-------------------------------------------------------------------------------------------------------+----------+------------+
| Water leakage from outside structure in last 12 months                                                | 18,900   | 8.44%      |
+-------------------------------------------------------------------------------------------------------+----------+------------+
| Uncomfortably cold for 24 hours or more last winter (occupying the same home, with heating equipment) | 12,300   | 6.61%      |
+-------------------------------------------------------------------------------------------------------+----------+------------+
| Broken windows\*                                                                                      | 7,600\*  | 6.46%\*    |
+-------------------------------------------------------------------------------------------------------+----------+------------+
| Open cracks or holes (interior)                                                                       | 14,400   | 6.43%      |
+-------------------------------------------------------------------------------------------------------+----------+------------+
| With fuse or breaker blown in last 3 months                                                           | 14,100   | 6.30%      |
+-------------------------------------------------------------------------------------------------------+----------+------------+
| Missing roofing material\*                                                                            | 7,000\*  | 5.95%\*    |
+-------------------------------------------------------------------------------------------------------+----------+------------+
| Mold in last 12 months                                                                                | 11,800   | 5.27%      |
+-------------------------------------------------------------------------------------------------------+----------+------------+
| Hole in roof\*                                                                                        | 4,200\*  | 3.57%\*    |
+-------------------------------------------------------------------------------------------------------+----------+------------+
| Missing bricks, siding, or other outside wall material\*                                              | 3,900\*  | 3.32%\*    |
+-------------------------------------------------------------------------------------------------------+----------+------------+
| With no toilet working some time in last 3 months                                                     | 7,000    | 3.13%      |
+-------------------------------------------------------------------------------------------------------+----------+------------+
| Rooms without electric outlets                                                                        | 6,600    | 2.95%      |
+-------------------------------------------------------------------------------------------------------+----------+------------+
| With water stoppage in last 3 months                                                                  | 6,400    | 2.86%      |
+-------------------------------------------------------------------------------------------------------+----------+------------+
| Broken plaster or peeling paint (interior)                                                            | 5,300    | 2.37%      |
+-------------------------------------------------------------------------------------------------------+----------+------------+
| Sewage breakdown in last 3 months                                                                     | 5,100    | 2.34%      |
+-------------------------------------------------------------------------------------------------------+----------+------------+
| Exposed wiring                                                                                        | 3,900    | 1.74%      |
+-------------------------------------------------------------------------------------------------------+----------+------------+

: Table 5: Housing Quality Problems in Memphis MSA

Problems related to the exterior of the structure are only collected for single-family structures; these have been marked with an asterisk (\*).
